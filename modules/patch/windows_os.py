#!/usr/bin/python3

import vulners

MY_API_KEY = "3JTYHVZCZOEHIKB8U251X66Q70M36WO1EAD1HTKIKMYWTSUV33XPRVFRPYRVEPSJ"

vuln = vulners.Vulners(api_key=MY_API_KEY)

os = "Windows Server 2012 R2 Standard"
kb = ["KB2868626",
 "KB2883200",
 "KB2887595",
 "KB2894852",
 "KB2894856",
 "KB2896496",
 "KB2903939",
 "KB2911106",
 "KB2919355",
 "KB2919394",
 "KB2919442",
 "KB2920189",
 "KB2928680",
 "KB2934504",
 "KB2934520",
 "KB2938066",
 "KB2954879",
 "KB2955164",
 "KB2959626",
 "KB2965500",
 "KB2966826",
 "KB2966828",
 "KB2967917",
 "KB2968296",
 "KB2969339",
 "KB2971203",
 "KB2972103",
 "KB2972213",
 "KB2973114",
 "KB2973448",
 "KB2975061",
 "KB2975719",
 "KB2976627",
 "KB2977765",
 "KB2978122",
 "KB2978126",
 "KB2984006",
 "KB2987107",
 "KB2989647",
 "KB2989930",
 "KB2993100",
 "KB2995004",
 "KB2995388",
 "KB2996799",
 "KB2998174",
 "KB2999226",
 "KB3000483",
 "KB3000850",
 "KB3003057",
 "KB3004545",
 "KB3008923",
 "KB3012199",
 "KB3012702",
 "KB3013172",
 "KB3013769",
 "KB3013791",
 "KB3013816",
 "KB3014442",
 "KB3019978",
 "KB3021910",
 "KB3021952",
 "KB3022345",
 "KB3023219",
 "KB3023222",
 "KB3023266",
 "KB3024751",
 "KB3024755",
 "KB3030947",
 "KB3032359",
 "KB3033446",
 "KB3035126",
 "KB3036612",
 "KB3037576",
 "KB3037579",
 "KB3038002",
 "KB3038701",
 "KB3042085",
 "KB3044374",
 "KB3044673",
 "KB3045634",
 "KB3045685",
 "KB3045717",
 "KB3045719",
 "KB3045755",
 "KB3045999",
 "KB3046017",
 "KB3046737",
 "KB3049563",
 "KB3050267",
 "KB3054169",
 "KB3054203",
 "KB3054256",
 "KB3054464",
 "KB3055323",
 "KB3055343",
 "KB3058515",
 "KB3059317",
 "KB3060681",
 "KB3060793",
 "KB3061512",
 "KB3063843",
 "KB3064209",
 "KB3065822",
 "KB3065988",
 "KB3068708",
 "KB3071756",
 "KB3072307",
 "KB3074228",
 "KB3074545",
 "KB3074548",
 "KB3075853",
 "KB3077715",
 "KB3078071",
 "KB3078405",
 "KB3080149",
 "KB3083325",
 "KB3083711",
 "KB3084135",
 "KB3084905",
 "KB3086255",
 "KB3087038",
 "KB3087137",
 "KB3091297",
 "KB3093983",
 "KB3094486",
 "KB3095701",
 "KB3097992",
 "KB3097997",
 "KB3098779",
 "KB3099834",
 "KB3100473",
 "KB3100773",
 "KB3102429",
 "KB3102467",
 "KB3102812",
 "KB3103616",
 "KB3103696",
 "KB3103709",
 "KB3104002",
 "KB3109103",
 "KB3109976",
 "KB3110329",
 "KB3112148",
 "KB3112336",
 "KB3115224",
 "KB3118401",
 "KB3121261",
 "KB3122651",
 "KB3122654",
 "KB3123245",
 "KB3124275",
 "KB3126434",
 "KB3126587",
 "KB3127222",
 "KB3127226",
 "KB3133043",
 "KB3133690",
 "KB3134179",
 "KB3134813",
 "KB3134814",
 "KB3134815",
 "KB3135449",
 "KB3135994",
 "KB3137728",
 "KB3138602",
 "KB3138615",
 "KB3139164",
 "KB3139398",
 "KB3139914",
 "KB3139929",
 "KB3140219",
 "KB3140234",
 "KB3141092",
 "KB3142026",
 "KB3142030",
 "KB3145384",
 "KB3145432",
 "KB3146604",
 "KB3146723",
 "KB3146751",
 "KB3147071",
 "KB3148198",
 "KB3148851",
 "KB3154070",
 "KB3155784",
 "KB3156059",
 "KB3156418",
 "KB3159398",
 "KB3161949",
 "KB3162343",
 "KB3162835",
 "KB3163291",
 "KB3172614",
 "KB3172729",
 "KB3173424",
 "KB3175024",
 "KB3175443",
 "KB3178539",
 "KB3179574",
 "KB3185319",
 "KB3205400",
 "KB3210132",
 "KB3210137",
 "KB4012864",
 "KB4014505",
 "KB4014510",
 "KB4014555",
 "KB4014581",
 "KB4014598",
 "KB4014661",
 "KB4015193",
 "KB4015547",
 "KB4020322",
 "KB4021558",
 "KB4022717",
 "KB4033428",
 "KB4034672",
 "KB4034733",
 "KB4041687",
 "KB4049068",
 "KB4051956",
 "KB4052978",
 "KB4054522",
 "KB4338419",
 "KB4338424",
 "KB4339284",
 "KB4343205",
 "KB4457143",
 "KB4457426",
 "KB4462901",
 "KB4468323",
 "KB4486105",
 "KB4501226",
 "KB4504418",
 "KB4506977",
 "KB4506996",
 "KB4507005",
 "KB4507434",
 "KB4507457",
 "KB4519108",
 "KB4524445",
 "KB4530677",
 "KB4530730",
 "KB4540725",
 "KB4541505"]

res=vuln.kbAudit(os=os, kb_list=kb)

for cve in res['cvelist']:
    print(cve, vuln.document(cve)['cvss']['score'])


